{% extends 'main/base.html' %}

{% block title %}
Home
{% endblock %}

{% block content %}

    <div class="table-responsive">
        
        <table id="list_crawlers" class="table table-striped table-bordered searchable sortable" cellspacing="0" width="100%">
            <thead>
                <tr>
                    <th scope="col">Nome</th>
                    <th scope="col">ID do Coletor</th>
                    <th scope="col">URL Base</th>
                    <th scope="col">Criado em</th>
                <th scope="col">Ações</th>
                    <th scope="col">Status</th>
                </tr>
            </thead>
            <tbody>
                {% for crawler in allcrawlers %}
                <tr>
                    <td>{{crawler.source_name}}</td>
                    <td>{{crawler.id}}</td>
                    <td>{{crawler.base_url}}</td>
                    <td>{{crawler.creation_date}}</td>
                    <td>
                        <div class="btn-group">
                            <a title="Detalhes" class="btn btn-info" href="{% url 'detail_crawler' crawler.id %}"><i class="fa fa-info-circle" aria-hidden="true"></i>
                            </a>
                            {% if crawler.waiting_on_queue %}
                                <a title="Remover da fila de coletas" class="btn btn-danger" href="{% url 'remove_crawl_request' crawler.id %}"><i class="fa fa-times" aria-hidden="true"></i>
                                </a>
                            {% else %}
                                {% if crawler.running == True %}
                                    <a title="Parar" class="btn btn-danger" href="{% url 'stop_crawl' crawler.id %}"><i class="fa fa-stop" aria-hidden="true"></i>
                                    </a>
                                {% else %}
                                    <a title="Começar" class="btn btn-success" href="{% url 'run_crawl' crawler.id %}"><i class="fa fa-play" aria-hidden="true"></i>
                                    </a>
                                {% endif %}
                            {% endif %}
                            
                            <a title="Editar" class="btn btn-primary" href="{% url 'edit_crawler' crawler.id %}"><i class="fa fa-pencil" aria-hidden="true"></i>
                            </a>
                        </div>
                    </td>
                    {% if crawler.waiting_on_queue %}
                        <td class="d-flex">
                            <span class="badge badge-info mr-1">Na fila</span>
                            {% if crawler.expected_runtime_category == 'fast' %}
                            <span class="badge badge-success">Rápida</span>
                            {% elif crawler.expected_runtime_category == 'medium' %}
                            <span class="badge badge-warning">Média</span>
                            {% else %}
                            <span class="badge badge-danger">Lenta</span>
                            {% endif %}
                        </td>
                    {% else  %}
                        {% if crawler.running == True %}
                            <td><span class="badge badge-success">Rodando</span></td>
                        {% else %}
                            <td><span class="badge badge-danger">Parado</span></td>
                        {% endif %}
                    {% endif %}
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
